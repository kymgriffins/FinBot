{% extends "base.html" %}

{% block title %}FinBot Dashboard - Advanced Financial Analytics{% endblock %}

{% block page_title %}Dashboard{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto">
  <!-- Welcome Section -->
  <div class="text-center mb-12">
    <h1 class="text-5xl font-bold text-gray-900 mb-4">
      Welcome to <span class="text-black">Gr8 Agency</span>
    </h1>
    <p class="text-xl text-gray-600 max-w-3xl mx-auto">
      Advanced financial analytics platform powered by AI and machine learning.
      Analyze market structures, predict trends, and make data-driven decisions.
    </p>
  </div>

  <!-- Quick Stats -->
  <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-12">
    <div class="metric-card text-center">
      <div class="text-3xl font-bold text-gray-900 mb-2">AI-Powered</div>
      <div class="text-gray-600">Weekly Analysis</div>
    </div>
    <div class="metric-card text-center">
      <div class="text-3xl font-bold text-gray-900 mb-2">Real-time</div>
      <div class="text-gray-600">Data Processing</div>
    </div>
    <div class="metric-card text-center">
      <div class="text-3xl font-bold text-gray-900 mb-2">Multi-Source</div>
      <div class="text-gray-600">Data Integration</div>
    </div>
    <div class="metric-card text-center">
      <div class="text-3xl font-bold text-gray-900 mb-2">Predictive</div>
      <div class="text-gray-600">Market Modeling</div>
    </div>
  </div>

  <!-- Main Features Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
    <!-- AI Weekly Analysis -->
    <div class="card p-8 hover:shadow-xl transition-all duration-300">
      <div class="flex items-center mb-6">
        <div class="w-12 h-12 bg-black rounded-lg flex items-center justify-center mr-4">
          <i class="fas fa-brain text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">AI Weekly Analysis</h3>
          <p class="text-gray-600">Advanced AI-powered market structure analysis</p>
        </div>
      </div>

      <div class="space-y-4 mb-6">
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Machine Learning Pattern Recognition</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Predictive Market Modeling</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Confidence Scoring</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Multi-Scenario Analysis</span>
        </div>
      </div>

      <a href="{{ url_for('web.ai_weekly') }}" class="btn-primary w-full text-center">
        <i class="fas fa-arrow-right mr-2"></i>Launch AI Analysis
      </a>
    </div>

    <!-- Traditional Weekly Analysis -->
    <div class="card p-8 hover:shadow-xl transition-all duration-300">
      <div class="flex items-center mb-6">
        <div class="w-12 h-12 bg-gray-800 rounded-lg flex items-center justify-center mr-4">
          <i class="fas fa-chart-network text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Weekly Analysis</h3>
          <p class="text-gray-600">Traditional market structure analysis</p>
        </div>
      </div>

      <div class="space-y-4 mb-6">
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Daily Profile Analysis</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Key Level Identification</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Trading Implications</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Market Narrative Generation</span>
        </div>
      </div>

      <a href="{{ url_for('web.weekly_analysis') }}" class="btn-secondary w-full text-center">
        <i class="fas fa-arrow-right mr-2"></i>Launch Analysis
      </a>
    </div>

    <!-- Data Sources -->
    <div class="card p-8 hover:shadow-xl transition-all duration-300">
      <div class="flex items-center mb-6">
        <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mr-4">
          <i class="fas fa-database text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Data Sources</h3>
          <p class="text-gray-600">Multiple financial data providers</p>
        </div>
      </div>

      <div class="grid grid-cols-2 gap-4 mb-6">
        <div class="text-center p-4 border border-gray-200 rounded-lg">
          <div class="text-lg font-semibold text-gray-900">YFinance</div>
          <div class="text-sm text-gray-600">Free Data</div>
        </div>
        <div class="text-center p-4 border border-gray-200 rounded-lg">
          <div class="text-lg font-semibold text-gray-900">FMP</div>
          <div class="text-sm text-gray-600">Professional</div>
        </div>
      </div>

      <a href="{{ url_for('yfinance.yfinance_dashboard') }}" class="btn-primary w-full text-center">
        <i class="fas fa-arrow-right mr-2"></i>View Data Sources
      </a>
    </div>

    <!-- Data Comparison -->
    <div class="card p-8 hover:shadow-xl transition-all duration-300">
      <div class="flex items-center mb-6">
        <div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center mr-4">
          <i class="fas fa-balance-scale text-white text-xl"></i>
        </div>
        <div>
          <h3 class="text-2xl font-bold text-gray-900">Data Comparison</h3>
          <p class="text-gray-600">Compare data across multiple sources</p>
        </div>
      </div>

      <div class="space-y-4 mb-6">
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Cross-Source Validation</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Data Quality Assessment</span>
        </div>
        <div class="flex items-center text-sm text-gray-600">
          <i class="fas fa-check-circle text-green-600 mr-2"></i>
          <span>Performance Metrics</span>
        </div>
      </div>

      <a href="{{ url_for('comparison.comparison_dashboard') }}" class="btn-secondary w-full text-center">
        <i class="fas fa-arrow-right mr-2"></i>Compare Data
      </a>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="card p-8 mb-12">
    <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">Quick Actions</h2>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="text-center">
        <div class="w-16 h-16 bg-black rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-chart-line text-white text-2xl"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">Analyze Symbol</h3>
        <p class="text-gray-600 mb-4">Get instant AI analysis for any symbol</p>
        <button onclick="quickAnalyze()" class="btn-primary">
          <i class="fas fa-play mr-2"></i>Quick Analyze
        </button>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-gray-800 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-code text-white text-2xl"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">API Documentation</h3>
        <p class="text-gray-600 mb-4">Comprehensive API reference</p>
        <a href="{{ url_for('web.api_docs') }}" class="btn-secondary">
          <i class="fas fa-book mr-2"></i>View Docs
        </a>
      </div>

      <div class="text-center">
        <div class="w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4">
          <i class="fas fa-heartbeat text-white text-2xl"></i>
        </div>
        <h3 class="text-xl font-semibold text-gray-900 mb-2">System Status</h3>
        <p class="text-gray-600 mb-4">Check system health and status</p>
        <button onclick="checkStatus()" class="btn-primary">
          <i class="fas fa-check mr-2"></i>Check Status
        </button>
      </div>
    </div>
  </div>

  <!-- Recent Activity -->
  <div class="card p-8">
    <h2 class="text-3xl font-bold text-gray-900 mb-6">System Overview</h2>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
      <div>
        <h3 class="text-xl font-semibold text-gray-900 mb-4">Available Features</h3>
        <div class="space-y-3">
          <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
            <div class="flex items-center">
              <i class="fas fa-brain text-purple-600 mr-3"></i>
              <span class="font-medium">AI Weekly Analysis</span>
            </div>
            <span class="status-indicator status-online"></span>
          </div>
          <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
            <div class="flex items-center">
              <i class="fas fa-chart-network text-blue-600 mr-3"></i>
              <span class="font-medium">Weekly Analysis</span>
            </div>
            <span class="status-indicator status-online"></span>
          </div>
          <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
            <div class="flex items-center">
              <i class="fas fa-database text-green-600 mr-3"></i>
              <span class="font-medium">Data Sources</span>
            </div>
            <span class="status-indicator status-online"></span>
          </div>
        </div>
      </div>

      <div>
        <h3 class="text-xl font-semibold text-gray-900 mb-4">Quick Stats</h3>
        <div class="space-y-4">
          <div class="flex justify-between items-center">
            <span class="text-gray-600">API Endpoints</span>
            <span class="font-semibold text-gray-900">15+</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-gray-600">Data Sources</span>
            <span class="font-semibold text-gray-900">3</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-gray-600">Analysis Types</span>
            <span class="font-semibold text-gray-900">5</span>
          </div>
          <div class="flex justify-between items-center">
            <span class="text-gray-600">Uptime</span>
            <span class="font-semibold text-green-600">99.9%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Quick Analyze Modal -->
<div id="quickAnalyzeModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white rounded-lg p-8 max-w-md w-full">
      <h3 class="text-2xl font-bold text-gray-900 mb-4">Quick Analysis</h3>
      <div class="mb-4">
        <label class="block text-sm font-medium text-gray-700 mb-2">Symbol</label>
        <input type="text" id="quickSymbol" placeholder="e.g., SPY, AAPL, TSLA"
          class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-black focus:border-transparent">
      </div>
      <div class="flex space-x-3">
        <button onclick="analyzeSymbol()" class="btn-primary flex-1">
          <i class="fas fa-play mr-2"></i>Analyze
        </button>
        <button onclick="closeModal()" class="btn-secondary flex-1">
          <i class="fas fa-times mr-2"></i>Cancel
        </button>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
  function quickAnalyze() {
    document.getElementById('quickAnalyzeModal').classList.remove('hidden');
    document.getElementById('quickSymbol').focus();
  }

  function closeModal() {
    document.getElementById('quickAnalyzeModal').classList.add('hidden');
  }

  function analyzeSymbol() {
    const symbol = document.getElementById('quickSymbol').value.trim().toUpperCase();
    if (!symbol) {
      alert('Please enter a symbol');
      return;
    }

    // Redirect to AI weekly analysis with the symbol
    window.location.href = `/ai-weekly?symbol=${symbol}`;
  }

  async function checkStatus() {
    try {
      const response = await fetch('/health');
      const data = await response.json();

      if (data.status === 'healthy') {
        alert('✅ System is healthy and operational!');
      } else {
        alert('⚠️ System status: ' + data.status);
      }
    } catch (error) {
      alert('❌ Unable to check system status');
    }
  }

  // Close modal on escape key
  document.addEventListener('keydown', function (e) {
    if (e.key === 'Escape') {
      closeModal();
    }
  });
</script>
{% endblock %}